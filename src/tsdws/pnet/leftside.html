<div class="accordion" id="accordionPanelsStayOpenExample">
    <div class="accordion-item">
        <h2 class="accordion-header" id="panelsStayOpen-headingOne">
            <button class="accordion-button p-2" type="button" data-bs-toggle="collapse" data-bs-target="#panelsStayOpen-collapseOne" aria-expanded="true" aria-controls="panelsStayOpen-collapseOne">
          Filters
        </button>
        </h2>
        <div id="panelsStayOpen-collapseOne" class="accordion-collapse collapse show" aria-labelledby="panelsStayOpen-headingOne">
            <div class="accordion-body">
                <div class="row row-cols-lg-auto align-items-center">

                    <div class="col-12 m-1">
                        <div class="input-group input-group-sm">
                            <div class="input-group-text"><i class="fa fa-filter"></i></div>
                            <input type="text" v-model="filters.name" class="form-control" id="filterSensorName" placeholder="Filter by name">
                            <button class="btn btn-light border" type="button" id="button-erase-name" @click="filters.name=''"><i class='fa fa-sm fa-delete-left'></i></button>
                        </div>
                    </div>

                    <div class="col-12 m-1">
                        <div class="input-group input-group-sm">
                            <div class="input-group-text">Net</div>
                            <button title="Reload nets" class="btn-light border" type="button" id="button-reload-net" @click="fetchNets()"><i class='fa fa-sm fa-rotate-right'></i></button>
                            <select class="form-select" id="input-net" v-model="filters.net_id" size="sm">
                                <option :value="resetID"> {{ defaultOption.nets }} </option>
                                <option v-for="item in nets" :value="item.id">{{ item.name }}</option>
                            <select>
                            <button v-if="filters.net_id!=0" title="Edit net settings" class="btn-light border" type="button" id="button-settings-net" @click="openEdit('net', filters.net_id)"><i class='fa fa-sm fa-gear'></i></button>
                            <button v-if="filters.net_id==0" title="Add new net" class="btn-light border" type="button" id="button-add-net" @click="openEdit('net')"><i class='fa fa-sm fa-plus'></i></button>
                        </div>
                    </div>
                
                    <div class="col-12 m-1">
                        <div class="input-group input-group-sm">
                            <div class="input-group-text">Sensortype</div>
                            <button title="Reload sensortypes" class="btn-light border" type="button" id="button-reload-net" @click="fetchSensortypes()"><i class='fa fa-sm fa-rotate-right'></i></button>
                            <select class="form-select" id="input-sensortype" v-model="filters.sensortype_id" size="sm">
                                <option :value="resetID"> {{ defaultOption.sensortypes }} </option>
                                <option v-for="item in sensortypes" :value="item.id">{{ item.name }}</option>
                            <select>
                            <button v-if="filters.sensortype_id!=0" title="Edit sensortypes settings" class="btn-light border" type="button" id="button-settings-sensortype" @click="openEdit('sensortype', filters.sensortype_id)"><i class='fa fa-sm fa-gear'></i></button>
                            <button v-if="filters.sensortype_id==0" title="Add new sensortype" class="btn-light border" type="button" id="button-add-sensortype" @click="openEdit('sensortype')"><i class='fa fa-sm fa-plus'></i></button>
                        </div>
                    </div>

                    <div class="col-12 m-1">
                        <div class="input-group input-group-sm">
                            <div class="input-group-text">Site</div>
                            <button title="Reload sites" class="btn-light border" type="button" id="button-reload-net" @click="fetchSites()"><i class='fa fa-sm fa-rotate-right'></i></button>
                            <select class="form-select" id="input-site" v-model="filters.site_id" size="sm">
                                <option :value="resetID"> {{ defaultOption.sites }} </option>
                                <option v-for="item in sites" :value="item.id">{{ item.name }}</option>
                            <select>
                            <button v-if="filters.site_id!=0" title="Edit sites settings" class="btn-light border" type="button" id="button-settings-site" @click="openEdit('site', filters.site_id)"><i class='fa fa-sm fa-gear'></i></button>
                            <button v-if="filters.site_id==0" title="Add new site" class="btn-light border" type="button" id="button-add-site" @click="openEdit('site')"><i class='fa fa-sm fa-plus'></i></button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<div class="row row-cols-lg-auto align-items-center m-0">
    <div class="col-12">
        <div class="showhim">
            <!--<input class="align-middle" type="checkbox" v-model="checkedAllSensors"/> --><span class="fst-italic align-middle">Nodes <small>({{sensorsList.length}})</small></span> <span class="showme"><span class="text-secondary" style="cursor:pointer" @click="sorting='byName'" v-show="sorting=='byNetAndName'"><i class="fa fa-arrow-up-a-z" title="Sort by name"></i></span> <span class="text-secondary" style="cursor:pointer" @click="sorting='byNetAndName'" v-show="sorting=='byName'"><i class="fa fa-arrow-up-short-wide" title="Sort by net and name"></i></span><span class="text-secondary" style="cursor:pointer" @click="fetchSensors()"><i class="fa fa-rotate-right" title="Reload nodes"></i></span> <span class="text-secondary" style="cursor:pointer"><i class="fa fa-plus" title="Create node" @click="openEdit('sensor')"></i></span></span>
        </div>
        <div v-if="sensorsList.length == 0" class="fst-italic">{{loadingMessages.sensors}}</div>
        <div v-if="sensorsList.length > 0">
            <ul id="sensorsList" class="list-group">
                <li class="list-group-item p-1 ps-0 pt-0 pb-0" v-for="sensor in sensorsList" :id="'sensor_'+sensor.id" v-show="!sensor.hidden" style="font-size:0.9em; border:none">
                        
                    <div class="showhim"><span><!--<input class="align-middle" type="checkbox" v-model="sensor.checked"/> --><i class="fa-solid fa-genderless"></i> <u title='Load channel list' class="font-monospace align-middle" style="cursor:pointer" @click="listElementAction(sensor.id)">{{ sensor.name }}</u><small class="font-monospace align-middle" title="Current (active) channels">({{sensor.n_channels}})</small> <span class="badge align-middle" :style="getNetColor(sensor.net_id)" style="padding:.2em .3em; font-size:.65em" :title="'Net:' + sensor.net_name">{{getNetAbbreviation(sensor.net_name)}}</span> <span class="badge rounded-pill align-middle" :style="getSensortypeColor(sensor.sensortype_id)" style="padding:.2em .45em; font-size:.65em" :title="'Sensortype:' + sensor.sensortype_name">{{getSensortypeAbbreviation(sensor.sensortype_name)}}</span></span> <span class='showme'><u class="text-secondary" style="cursor:pointer" @click="fetchChannels({sensor_id: sensor.id})"><i class="fa fa-rotate-right" title="Reload channels"></i></u> <u class="text-secondary" style="cursor:pointer" @click="openEdit('sensor',sensor.id)"><i class="fa fa-gear" title="View/edit sensor"></i></u> <u class="text-secondary" style="cursor:pointer" @click="removeSensor(sensor.id)"><i class="fa fa-trash" title="Remove sensor"></i></u></span></div>

                        <ul v-if="channelsList[sensor.id]" v-show="!channelsList[sensor.id].hidden" class='fa-ul'>
                            <li v-for="c in channelsList[sensor.id]" :id="'channel_'+c.id">
                                <div v-if="!c.old_channel || seeOldChannels">
                                    <div class="showhim">
                                        <span class="text-secondary fa-li" @click="">#{{c.id}}</span> 

                                        <u v-if="(timeseriesList[c.id] && timeseriesList[c.id].length>0)" title='Load timeseries list' class="font-monospace align-middle" :class="{'text-danger':c.old_channel}" style="cursor:pointer" @click="toggleTimeseriesList(c.id)"><i v-if="c.old_channel" class="fa-regular fa-clock" title="Old channel"></i>{{c.name}}</u> 
                                        <span v-if="(!timeseriesList[c.id] || timeseriesList[c.id].length == 0)" title="" class="font-monospace align-middle" :class="{'text-danger':c.old_channel}"><i v-if="c.old_channel" class="fa-regular fa-clock" title="Old channel"></i>{{c.name}}</span> <span class="badge rounded-pill align-middle" :style="getSensortypeColor(c.sensortype_id)" style="padding:.2em .45em; font-size:.65em" :title="'Sensortype:' + c.sensortype_name">{{getSensortypeAbbreviation(c.sensortype_name)}}</span>&nbsp;
    
                                        <u><i class="fa fa-chart-line fa-xs" title="Mapped timeseries"> <span class="font-monospace">[{{timeseriesList[c.id] ? timeseriesList[c.id].length : ""}}]</span></i></u> <span class='showme'><u class="text-secondary" style="cursor:pointer" @click="fetchTimeseries({channel_id: c.id})"><i class="fa fa-rotate-right" title="Reload timeseries"></i></u> <u class="text-secondary" style="cursor:pointer" @click="openEdit('channel',c.id, {'sensor_id':sensor.id})"><i class="fa fa-gear" title="View/edit channel"></i></u> <u class="text-secondary" style="cursor:pointer" @click="cloneChannel(c.id, sensor.id)"><i class="fa-regular fa-clone" title="Duplicate channel"></i></u> <u class="text-secondary" style="cursor:pointer"><i class="fa fa-folder-plus" title="Register a new timeseries and map to this channel" @click="openEdit('timeseries', null, {'channel_id':c.id})"></i></u> <u class="text-secondary" style="cursor:pointer" @click="removeChannel(c.id, sensor.id)"><i class="fa fa-trash" title="Remove channel"></i></u></span>

                                    </div>
                                    <ul v-if="timeseriesList[c.id]" v-show="!timeseriesList[c.id].hidden" class='fa-ul'>
                                        <li v-for="t in timeseriesList[c.id]" :id="'timeseries_'+t.id">
                                            <div class="showhim">
                                                <i class="fa-li fa fa-chart-line" title="Timeseries"></i>{{t.name}} 
                                                
                                                <u class="text-primary"><i class="fa fa-table-columns fa-xs" title="Timeseries columns"> <span class="font-monospace">[{{t.columns === null ? "?" : t.columns.length}}]</span></i></u> <span class="showme"><span class="text-secondary" style="cursor:pointer" @click="openTSViewer(t.id, t.columns)"><i class="fa fa-eye" title="View timeseries"></i></span> <span class="text-secondary" style="cursor:pointer" @click="openEdit('timeseries', t.id, {'sensor_id':sensor.id, 'channel_id':c.id});"><i class="fa fa-gear" title="Edit timeseries"></i></span></span>
                                            </div>
                                        </li>
                                    </ul>
                                </div>
                            </li>
                            <li class="fst-italic"><i class="fa-li fa fa-plus"></i><u class="text-primary" style="cursor:pointer" @click="openEdit('channel', null, {'sensor_id':sensor.id})">&lt;add channel&gt;</u></li>
                        </ul>
                </li>
            </ul>
        </div>
    </div>
</div>